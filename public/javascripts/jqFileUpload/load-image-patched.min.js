(function(b){var c=function(g,i,f){var d=document.createElement("img"),e,h;d.onerror=i;d.onload=function(){if(h&&!(f&&f.noRevoke)){c.revokeObjectURL(h)}i(c.scale(d,f))};if((window.Blob&&g instanceof Blob)||(window.File&&g instanceof File)){e=h=c.createObjectURL(g);d._type=g.type}else{e=g}if(g.type.toString().toUpperCase()==="APPLICATION/PDF"){e="/images/pdf-medium.png"}if(e){d.src=e;return d}return c.readFile(g,function(k){var j=k.target;if(j&&j.result){d.src=j.result}else{i(k)}})},a=(window.createObjectURL&&window)||(window.URL&&URL.revokeObjectURL&&URL)||(window.webkitURL&&webkitURL);c.detectSubsampling=function(f){var e=f.width,h=f.height,g,d;if(e*h>1024*1024){g=document.createElement("canvas");g.width=g.height=1;d=g.getContext("2d");d.drawImage(f,-e+1,0);return d.getImageData(0,0,1,1).data[3]===0}return false};c.detectVerticalSquash=function(g,k){var d=document.createElement("canvas"),l=d.getContext("2d"),f,i,h,j,e;d.width=1;d.height=k;l.drawImage(g,0,0);f=l.getImageData(0,0,1,k).data;i=0;h=k;j=k;while(j>i){e=f[(j-1)*4+3];if(e===0){h=j}else{i=j}j=(h+i)>>1}return j/k};c.renderImageToCanvas=function(h,f,e,q){var g=h.width,r=h.height,s=f.getContext("2d"),k,j=1024,n=document.createElement("canvas"),p,l,i,m,o;s.save();if(c.detectSubsampling(h)){g/=2;r/=2}k=c.detectVerticalSquash(h,r);n.width=n.height=j;p=n.getContext("2d");l=0;while(l<r){i=l+j>r?r-l:j;m=0;while(m<g){o=m+j>g?g-m:j;p.clearRect(0,0,j,j);p.drawImage(h,-m,-l);s.drawImage(n,0,0,o,i,Math.floor(m*e/g),Math.floor(l*q/r/k),Math.ceil(o*e/g),Math.ceil(i*q/r/k));m+=j}l+=j}s.restore();n=p=null};c.scale=function(e,g){g=g||{};var f=document.createElement("canvas"),h=e.width,d=e.height,i=Math.max((g.minWidth||h)/h,(g.minHeight||d)/d);if(i>1){h=parseInt(h*i,10);d=parseInt(d*i,10)}i=Math.min((g.maxWidth||h)/h,(g.maxHeight||d)/d);if(i<1){h=parseInt(h*i,10);d=parseInt(d*i,10)}if(e.getContext||(g.canvas&&f.getContext)){f.width=h;f.height=d;if(e._type==="image/jpeg"){c.renderImageToCanvas(e,f,h,d)}else{f.getContext("2d").drawImage(e,0,0,h,d)}return f}e.width=h;e.height=d;return e};c.createObjectURL=function(d){return a?a.createObjectURL(d):false};c.revokeObjectURL=function(d){return a?a.revokeObjectURL(d):false};c.readFile=function(e,f){if(window.FileReader&&FileReader.prototype.readAsDataURL){var d=new FileReader();d.onload=d.onerror=f;d.readAsDataURL(e);return d}return false};if(typeof define==="function"&&define.amd){define(function(){return c})}else{b.loadImage=c}}(this));